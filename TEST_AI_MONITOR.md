# 🧪 AI视频监控功能测试指南

## 🚀 快速测试步骤

### 1. 启动所有服务

```bash
# 终端1: 启动AI服务
cd smart_station_platform/ai_service
python app.py

# 终端2: 启动后端服务  
cd smart_station_platform/backend
python -m daphne -p 8000 smart_station.asgi:application

# 终端3: 启动前端服务
cd smart_station_platform/frontend
npm run dev
```

### 2. 访问AI监控界面

1. 打开浏览器访问 `http://localhost:5173`
2. 点击Dashboard中的 **"🤖 AI实时分析"** 按钮
3. 或直接访问 `http://localhost:5173/ai-monitor`

### 3. 基础功能测试

#### ✅ 摄像头启动测试
- 点击 **"启动摄像头"** 按钮
- 允许浏览器访问摄像头权限
- 确认视频画面正常显示

#### ✅ AI分析启动测试  
- 点击 **"开启AI分析"** 按钮
- 观察右上角状态变为 **"AI分析中"**
- 等待AI服务响应（首次可能需要几秒）

#### ✅ 人员检测测试
- 确保画面中有人员
- 观察视频上是否出现蓝色检测框
- 查看右侧检测结果面板

#### ✅ 人脸识别测试
- 将脸部对准摄像头
- 观察是否出现绿色（已知）或红色（未知）人脸框
- 检查告警面板是否显示未知人脸告警

## 🔍 测试期望结果

### 正常工作状态
- ✅ 摄像头画面清晰流畅
- ✅ AI分析状态显示"分析中"
- ✅ 检测框正确标记在目标上
- ✅ 检测结果面板实时更新
- ✅ 未知人脸触发告警通知

### API接口测试

#### 测试帧分析接口
```bash
# 上传一张测试图片到AI服务
curl -X POST "http://localhost:8001/frame/analyze/" \
  -F "frame=@test_image.jpg" \
  -F "camera_id=test_camera" \
  -F "enable_face_recognition=true" \
  -F "enable_object_detection=true"
```

#### 查看AI服务状态
```bash
curl http://localhost:8001/system/status/
```

#### 查看后端告警数据
```bash
curl http://localhost:8000/api/alerts/list/
```

## 🐛 常见问题排查

### 摄像头无法启动
- 检查浏览器权限设置
- 确认其他应用没有占用摄像头
- 尝试刷新页面重新授权

### AI分析无响应
- 确认AI服务正常运行 (http://localhost:8001)
- 检查控制台错误信息
- 验证AI模型文件是否存在

### 检测结果不显示
- 确保光线充足
- 检测目标距离摄像头合适
- 调整检测频率设置

### 告警未保存
- 确认后端服务运行 (http://localhost:8000)
- 检查数据库连接状态
- 查看后端服务日志

## 📊 性能验证

### 检测精度测试
- 人员检测置信度应 > 70%
- 人脸识别准确率应 > 80%  
- 误报率应 < 10%

### 响应时间测试
- 摄像头启动 < 3秒
- AI分析延迟 < 2秒
- 告警生成 < 1秒

### 资源消耗监控
- CPU使用率 < 80%
- 内存占用 < 4GB
- 网络带宽 < 10Mbps

## 🎯 功能验证清单

- [ ] 摄像头设备选择正常
- [ ] 视频流启动成功
- [ ] AI分析状态切换正常
- [ ] 目标检测框显示正确
- [ ] 人脸识别结果准确
- [ ] 检测结果面板更新
- [ ] 实时告警触发正常
- [ ] 告警保存到数据库
- [ ] 设置调整生效
- [ ] 停止功能正常

## 📝 测试记录模板

```
测试时间: ________
测试环境: ________
测试人员: ________

功能测试结果:
✅/❌ 摄像头启动
✅/❌ AI分析启动  
✅/❌ 人员检测
✅/❌ 人脸识别
✅/❌ 告警生成
✅/❌ 数据保存

性能指标:
- 启动时间: ___秒
- 分析延迟: ___毫秒  
- CPU使用: ___%
- 内存占用: ___MB

发现问题:
1. ________________
2. ________________

改进建议:
1. ________________
2. ________________
```

通过以上测试，您可以全面验证AI视频监控功能是否正常工作！ 